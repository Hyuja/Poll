{% extends 'base.html' %}
{% load account %}
{% load static %}
<!-- ====================================================   -->
{% block title %}
<title>Poll</title>
<link href="{% static 'css/grid.css' %}" rel="stylesheet">
<link href="{% static 'css/divclick.css' %}" rel="stylesheet">
{% endblock %}

{% block content %}
<main class = "py-4"><br><br>

{% if user.is_authenticated %}
  <div align = "middle">
    <div class = "container">
      <form method = "POST" action = "{% url 'pollprocess' %}"></form>  
      
        {% for POLL_CASE in POLL_CASES %}
          <h1 class="mt-4">{{POLL_CASE.poll_name}}</h1><br>
          
          {% csrf_token %}
          
            {% for Candidate in Candidates %} 
              <!-- 선거별로 후보 분류 -->
              {% if Candidate.Poll_Case_id == POLL_CASE %}
                <div class="row row-cols-1 row-cols-md-3 gx-4">
                  <div class="col themed-grid-col">{{Candidate.CandidateNum}}</div>
                  <div class="col themed-grid-col">{{Candidate.side}}</div>
                  <div class="col themed-grid-col">{{Candidate.CandidateName}}</div>
                </div>
              {% endif %}
            {% endfor %}
            <br><br><br>
        {% endfor %}
        <!-- 버튼 하나로 POLL_CASES 수만큼 정보 전달  -->
        <br>
        <button type="submit" class="btn btn-primary btn-lg">Submit</button>   
      </form> 
    </div> 
  </div>
{% endif %}

{% if user.is_anonymous %}
  <div align = "middle">
    Please Login to access this page
  </div>
{% endif %}

</main>
<script>
  var div2 = document.getElementsByClassName("div2");

  function handleClick(event) {
  console.log(event.target);
  // console.log(this);
  // 콘솔창을 보면 둘다 동일한 값이 나온다

  console.log(event.target.classList);

  if (event.target.classList[1] === "clicked") {
    event.target.classList.remove("clicked");
  } else {
    for (var i = 0; i < div2.length; i++) {
      div2[i].classList.remove("clicked");
    }

    event.target.classList.add("clicked");
  }
  }

  function init() {
  for (var i = 0; i < div2.length; i++) {
    div2[i].addEventListener("click", handleClick);
  }
  }

  init();
</script>
{% endblock %}